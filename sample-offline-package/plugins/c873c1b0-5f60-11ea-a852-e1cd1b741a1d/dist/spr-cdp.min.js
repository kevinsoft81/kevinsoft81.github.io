!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("CDP",[],r):"object"==typeof exports?exports.CDP=r():e.CDP=r()}("undefined"!=typeof self?self:this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var t={};return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s=10)}([function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.CDP="CDP",r.PARENT="PARENT",r.STATE_RESOURCE="STATE_RESOURCE",r.CHILD_RESOURCE="CHILD_RESOURCE",r.DRAG_STATE_RESOURCE="DRAG_STATE_RESOURCE",r.EDITOR_RESOURCE="EDITOR_RESOURCE",r.LEARNER_RESOURCE="LEARNER_RESOURCE",r.THEME_RESOURCE="THEME_RESOURCE",r.PROGRESS_RESOURCE="PROGRESS_RESOURCE",r.ACCESS_RESOURCE="ACCESS_RESOURCE",r.CLASS_RESOURCE="CLASS_RESOURCE",r.USER_RESOURCE="USER_RESOURCE",r.CONTEXT_RESOURCE="CONTEXT_RESOURCE",r.FEATURE_TOGGLE_RESOURCE="FEATURE_TOGGLE_RESOURCE",r.ASSET_RESOURCE="ASSET_RESOURCE",r.SUBSCRIPTION_RESOURCE="SUBSCRIPTION_RESOURCE",r.DEPRECATED_RESOURCE="DEPRECATED_RESOURCE",r.COMPETENCY_RESOURCE="COMPETENCY_RESOURCE",r.QUERY_RESOURCE="QUERY_RESOURCE",r.EXECUTE_QUERY="EXECUTE_QUERY",r.SUBSCRIPTION="SUBSCRIPTION",r.SUBSCRIBE="SUBSCRIBE",r.SET="SET",r.GET="GET",r.REGISTER="REGISTER",r.IS="IS",r.INIT_CHILD="INIT_CHILD",r.GET_NONCE="GET_NONCE",r.REMOVE_CHILD="REMOVE_CHILD",r.CREATE_CHILD="CREATE_CHILD",r.DELETE_CHILD="DELETE_CHILD",r.SUBSCRIBE_TO_DRAGGABLES="SUBSCRIBE_TO_DRAGGABLES",r.UNSUBSCRIBE_FROM_DRAGGABLES="UNSUBSCRIBE_FROM_DRAGGABLES",r.SELECT="SELECT",r.SUBSCRIBE_TO_SELECTION="SUBSCRIBE_TO_SELECTION",r.OPEN="OPEN",r.EVALUATE="EVALUATE",r.RESTART="RESTART",r.SUBSCRIBE_TO_THEME_CSS="SUBSCRIBE_TO_THEME_CSS",r.PROVISION_UPLOAD="PROVISION_UPLOAD",r.GET_RESOURCE="GET_RESOURCE",r.ADD_ASSET="ADD_ASSET",r.GET_SUBSCRIPTION="GET_SUBSCRIPTION",r.INFORM_ASSET_USAGE="INFORM_ASSET_USAGE",r.DEPRECATED_CONTINUE="DEPRECATED_CONTINUE"},function(e,r,t){"use strict";function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function o(e){var r=void 0;try{r=!!e.frameElement}catch(e){r=!1}return r}Object.defineProperty(r,"__esModule",{value:!0}),r.listenOnce=r.createListener=r.post=void 0,r.frameElementIsAccessible=o;var i=t(12),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=t(14),u=t(0),c=function(){for(var e=window;o(e)&&e!==window.top;)e=e.parent;return e}(),l=function(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.CDP,t=(e={},n(e,u.CDP,c.parent),n(e,u.PARENT,window.parent),e)[r];if(t===window)throw new Error("can't find target window");return t};r.post=function(e){var r=e.targetResource,t=e.fnName,n=e.payload,o=e.targetWindow;return a.default.send(l(o),(0,s.buildName)(r,t),n)},r.createListener=function(e){var r=e.resource,t=e.fnName,n=e.callback;return a.default.on((0,s.buildName)(r,t),n)},r.listenOnce=function(e){var r=e.fnName,t=e.window,n=e.callback;return a.default.once(r,{window:t},n)}},function(e,r,t){"use strict";function n(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function o(){var e={};return e.promise=new Promise(function(r,t){e.resolve=r,e.reject=t}),e}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),a=function(){function e(r,t){var o=this;n(this,e),this.queue=[],this.waiting=[],this.unsubscribeFn=t,r({next:function(e){if(o.waiting.length>0){return o.waiting.shift().resolve({done:!1,value:e})}return o.queue.push({type:"next",value:e})},throw:function(e){if(o.waiting.length>0){return o.waiting.shift().reject(e)}return o.queue.push({value:e,type:"error"})},return:function(e){if(o.waiting.length>0){return o.waiting.shift().resolve({done:!0,value:e})}return o.queue.push({value:e,type:"return"})}})}return i(e,[{key:"unsubscribe",value:function(){this.unsubscribeFn()}},{key:"next",value:function(){if(this.queue.length>1){var e=this.queue.shift();return"return"===e.type?Promise.resolve({done:!0,value:e.value}):"error"===e.type?Promise.reject(e.value):Promise.resolve({done:!1,value:e.value})}var r=o();return this.waiting.push(r),r.promise}},{key:Symbol.asyncIterator,value:function(){return this}}]),e}();r.default=a,e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(1),o=t(0),i=t(2),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=t(4),u=function(e,r,t,n){var o=n.file,i=n.metadata;return(0,s.uploadResource)(r,t,o,i).then(function(e){return e.urn}).then(function(e){return(0,s.informAssetUsage)(e)})},c=function(e,r){return(0,s.provisionUpload)().then(function(e){var t=e.data,n=t.nonce,o=t.uploadURL,i=r.map(function(e){return u(0,o,n,e)});return Promise.all(i)})},l=function(e,r){return new a.default(function(r){(0,n.createListener)({resource:o.SUBSCRIPTION,fnName:e,callback:function(e){r.next(e.data)}})},r)},f=function(e,r){return{get:function(){return(0,n.post)({targetResource:o.STATE_RESOURCE,fnName:o.GET,payload:{path:r,id:e}}).then(function(e){return e.data})},set:function(t){return(0,n.post)({targetResource:o.STATE_RESOURCE,fnName:o.SET,payload:{path:r,value:t,id:e}})},setImage:function(t){return c(0,[t]).then(function(t){return(0,n.post)({targetResource:o.STATE_RESOURCE,fnName:o.SET,payload:{path:r,value:t.length?t[0]:void 0,id:e}})})},setImages:function(t){return c(0,t).then(function(t){return(0,n.post)({targetResource:o.STATE_RESOURCE,fnName:o.SET,payload:{path:r,value:t.length?t:void 0,id:e}})})},subscribe:function(t){return(0,n.post)({targetResource:o.STATE_RESOURCE,fnName:o.SUBSCRIBE,payload:{path:r,optionalCallbackFn:t,id:e}}).then(function(e){var r=e.data,n=r.subscriptionId,o=r.unsubscribe;return t?{subscriptionId:n,unsubscribe:o}:l(n,o)})}}},d=function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(t){var n=f(e,t),o=n.get,i=n.set,a=n.setImage,s=n.setImages,u=n.subscribe;return r?{get:o,subscribe:u}:{get:o,set:i,setImage:a,setImages:s,subscribe:u}}};r.default=d,e.exports=r.default},function(e,r,t){"use strict";function n(){}function o(){return(0,c.post)({targetResource:l.ASSET_RESOURCE,fnName:l.PROVISION_UPLOAD})}function i(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,c.post)({targetResource:l.ASSET_RESOURCE,fnName:l.GET_SUBSCRIPTION}).then(function(t){var n=t.data,o=new FormData;return o.append("file",e),o.append("visibility","GLOBAL"),o.append("subscriptionId",n),o.append("metadata",JSON.stringify(r)),o})}function a(e,r,t,n){return i(t,n).then(function(t){return fetch(""+e,{method:"POST",headers:{Authorization:"Bearer "+r},body:t})}).then(function(e){return e.json()})}function s(e){return(0,c.post)({targetResource:l.ASSET_RESOURCE,fnName:l.INFORM_ASSET_USAGE,payload:e}).then(function(){return e})}function u(){n()}Object.defineProperty(r,"__esModule",{value:!0}),r.resolveAsset=r.informAssetUsage=r.uploadResource=r.provisionAssetData=r.provisionUpload=void 0,t(15);var c=t(1),l=t(0);r.provisionUpload=o,r.provisionAssetData=i,r.uploadResource=a,r.informAssetUsage=s,r.resolveAsset=u},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(6),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.default=(0,i.default)(n.ACCESS_RESOURCE),e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(1),o=t(2),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=t(0),s=function(e){return new i.default(function(r){(0,n.createListener)({resource:a.SUBSCRIPTION,fnName:e,callback:function(e){r.next(e.data)}})})},u=function(e){return function(r){return{get:function(){return(0,n.post)({targetResource:e,fnName:a.GET,payload:{path:r}}).then(function(e){return e.data})},subscribe:function(t){return(0,n.post)({targetResource:e,fnName:a.SUBSCRIBE,payload:{path:r,optionalCallbackFn:t}}).then(function(e){var r=e.data;return t?r:s(r)})}}}};r.default=u,e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(1),o=t(2),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=t(0),s=function(e){return new i.default(function(r){(0,n.createListener)({resource:a.SUBSCRIPTION,fnName:e,callback:function(e){r.next(e.data)}})})},u=function(e){return function(r){return{get:function(){return(0,n.post)({targetResource:a.PROGRESS_RESOURCE,fnName:a.GET,payload:{id:e,path:r}}).then(function(e){return e.data})},subscribe:function(t){return(0,n.post)({targetResource:a.PROGRESS_RESOURCE,fnName:a.SUBSCRIBE,payload:{id:e,path:r,optionalCallbackFn:t}}).then(function(e){var r=e.data;return t?r:s(r)})}}}};r.default=u,e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(1),o=t(2),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=t(0),s=function(e){return new i.default(function(r){(0,n.createListener)({resource:a.SUBSCRIPTION,fnName:e,callback:function(e){r.next(e.data)}})})},u=function(e){return function(r,t){return{get:function(){return(0,n.post)({targetResource:a.COMPETENCY_RESOURCE,fnName:a.GET,payload:{id:e,documentId:r,itemId:t}}).then(function(e){return e.data})},subscribe:function(o){return(0,n.post)({targetResource:a.COMPETENCY_RESOURCE,fnName:a.SUBSCRIBE,payload:{id:e,documentId:r,itemId:t,optionalCallbackFn:o}}).then(function(e){var r=e.data;return o?r:s(r)})}}}};r.default=u,e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(1),i=function(e){return function(){return{evaluate:function(r){return(0,o.post)({targetResource:n.LEARNER_RESOURCE,fnName:n.EVALUATE,payload:{id:e||r}}).then(function(e){return e.data})},restart:function(r){return(0,o.post)({targetResource:n.LEARNER_RESOURCE,fnName:n.RESTART,payload:{activityId:e||r}}).then(function(e){return e.data})}}}};r.default=i,e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(11),o={register:n.register,state:n.state,child:n.child,editor:n.editor,learner:n.learner,dragState:n.dragState,theme:n.theme,context:n.context,user:n.user,access:n.access,progress:n.progress,cohort:n.cohort,features:n.featureToggle,__query:n.query,__deprecated:n.__deprecated,competency:n.competency};r.default=o,e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.__deprecated=r.query=r.competency=r.asset=r.featureToggle=r.context=r.cohort=r.progress=r.access=r.user=r.dragState=r.child=r.theme=r.learner=r.editor=r.state=r.register=r.registerAsChildPlugin=void 0;var i=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),a=t(3),s=n(a),u=t(16),c=n(u),l=t(17),f=n(l),d=t(9),p=n(d),h=t(18),E=n(h),y=t(22),m=n(y),_=t(1),v=t(0),S=t(23),b=n(S),O=t(24),g=n(O),w=t(5),T=n(w),R=t(7),A=n(R),P=t(25),C=n(P),j=t(26),N=n(j),I=t(4),M=n(I),L=t(27),x=n(L),D=t(28),k=n(D),U=t(8),G=n(U),W=void 0,B=r.registerAsChildPlugin=function(){if(!W)try{W=(0,_.post)({fnName:v.GET_NONCE,targetWindow:v.PARENT,payload:{}}).then(function(e){return(0,_.post)({targetResource:v.REGISTER,fnName:e.data.nonce,payload:e.data})})}catch(e){W=new Promise(function(r,t){return setTimeout(function(){return t(e)},0)})}return W},F=function(){if(!W)try{W=(0,_.post)({fnName:v.REGISTER,payload:{}})}catch(e){W=new Promise(function(r,t){return setTimeout(function(){return t(e)},0)})}return W},H=function(){function e(){o(this,e),this.childResources={}}return i(e,[{key:"createChildResource",value:function(e){if(this.childResources[e])return this.childResources[e];var r=new c.default(e);return this.childResources[e]=r,r}}]),e}(),q=new H;r.register=(0,_.frameElementIsAccessible)(window)?B:F,r.state=function(e){return(0,s.default)()(e)},r.editor=function(){return(0,f.default)()},r.learner=function(){return(0,p.default)()()},r.theme=function(e){return(0,m.default)(e)},r.child=function(e){return q.createChildResource(e)},r.dragState=E.default,r.user=function(e){return(0,b.default)(e)},r.access=function(e){return(0,T.default)(e)},r.progress=function(e){return(0,A.default)()(e)},r.cohort=function(e){return(0,g.default)(e)},r.context=function(){return(0,C.default)()},r.featureToggle=function(e){return(0,N.default)(e)},r.asset=function(){return M.default},r.competency=function(e,r){return(0,G.default)()(e,r)},r.query=x.default,r.__deprecated=function(){return(0,k.default)()}},function(e,r,t){e.exports=t(13),e.exports.default=e.exports},function(e,r,t){!function(r,t){e.exports=t()}("undefined"!=typeof self&&self,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var t={};return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s="./src/index.js")}({"./node_modules/cross-domain-safe-weakmap/src/index.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./node_modules/cross-domain-safe-weakmap/src/interface.js");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})});var o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}(n);r.default=o},"./node_modules/cross-domain-safe-weakmap/src/interface.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./node_modules/cross-domain-safe-weakmap/src/weakmap.js");Object.defineProperty(r,"WeakMap",{enumerable:!0,get:function(){return n.CrossDomainSafeWeakMap}})},"./node_modules/cross-domain-safe-weakmap/src/native.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.hasNativeWeakMap=function(){if(!window.WeakMap)return!1;if(!window.Object.freeze)return!1;try{var e=new window.WeakMap,r={};return window.Object.freeze(r),e.set(r,"__testvalue__"),"__testvalue__"===e.get(r)}catch(e){return!1}}},"./node_modules/cross-domain-safe-weakmap/src/util.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.safeIndexOf=function(e,r){for(var t=0;t<e.length;t++)try{if(e[t]===r)return t}catch(e){}return-1},r.noop=function(){}},"./node_modules/cross-domain-safe-weakmap/src/weakmap.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CrossDomainSafeWeakMap=void 0;var n=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),o=t("./node_modules/cross-domain-utils/src/index.js"),i=t("./node_modules/cross-domain-safe-weakmap/src/native.js"),a=t("./node_modules/cross-domain-safe-weakmap/src/util.js"),s=Object.defineProperty,u=Date.now()%1e9;r.CrossDomainSafeWeakMap=function(){function e(){if(function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),u+=1,this.name="__weakmap_"+(1e9*Math.random()>>>0)+"__"+u,(0,i.hasNativeWeakMap)())try{this.weakmap=new window.WeakMap}catch(e){}this.keys=[],this.values=[]}return n(e,[{key:"_cleanupClosedWindows",value:function(){for(var e=this.weakmap,r=this.keys,t=0;t<r.length;t++){var n=r[t];if((0,o.isWindow)(n)&&(0,o.isWindowClosed)(n)){if(e)try{e.delete(n)}catch(e){}r.splice(t,1),this.values.splice(t,1),t-=1}}}},{key:"isSafeToReadWrite",value:function(e){if((0,o.isWindow)(e))return!1;try{(0,a.noop)(e&&e.self),(0,a.noop)(e&&e[this.name])}catch(e){return!1}return!0}},{key:"set",value:function(e,r){if(!e)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{t.set(e,r)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var n=this.name,o=e[n];o&&o[0]===e?o[1]=r:s(e,n,{value:[e,r],writable:!0})}else{this._cleanupClosedWindows();var i=this.keys,u=this.values,c=(0,a.safeIndexOf)(i,e);-1===c?(i.push(e),u.push(r)):u[c]=r}}},{key:"get",value:function(e){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{if(r.has(e))return r.get(e)}catch(e){delete this.weakmap}if(!this.isSafeToReadWrite(e)){this._cleanupClosedWindows();var t=this.keys,n=(0,a.safeIndexOf)(t,e);if(-1===n)return;return this.values[n]}var o=e[this.name];if(o&&o[0]===e)return o[1]}},{key:"delete",value:function(e){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{r.delete(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var t=e[this.name];t&&t[0]===e&&(t[0]=t[1]=void 0)}else{this._cleanupClosedWindows();var n=this.keys,o=(0,a.safeIndexOf)(n,e);-1!==o&&(n.splice(o,1),this.values.splice(o,1))}}},{key:"has",value:function(e){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{return r.has(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var t=e[this.name];return!(!t||t[0]!==e)}return this._cleanupClosedWindows(),-1!==(0,a.safeIndexOf)(this.keys,e)}}]),e}()},"./node_modules/cross-domain-utils/src/index.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./node_modules/cross-domain-utils/src/utils.js");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})});var o=t("./node_modules/cross-domain-utils/src/types.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}})})},"./node_modules/cross-domain-utils/src/types.js":function(e,r,t){"use strict"},"./node_modules/cross-domain-utils/src/util.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isRegex=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},r.noop=function(){}},"./node_modules/cross-domain-utils/src/utils.js":function(e,r,t){"use strict";function n(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).location.protocol===P.ABOUT_PROTOCOL}function o(e){if(e)try{if(e.parent&&e.parent!==e)return e.parent}catch(e){}}function i(e){if(e&&!o(e))try{return e.opener}catch(e){}}function a(e){try{return(0,A.noop)(e&&e.location&&e.location.href),!0}catch(e){}return!1}function s(e){var r=e.location;if(!r)throw new Error("Can not read window location");var t=r.protocol;if(!t)throw new Error("Can not read window protocol");if(t===P.FILE_PROTOCOL)return P.FILE_PROTOCOL+"//";if(t===P.ABOUT_PROTOCOL){var n=o(e);return n&&a(e)?s(n):P.ABOUT_PROTOCOL+"//"}var i=r.host;if(!i)throw new Error("Can not read window host");return t+"//"+i}function u(e){var r=s(e=e||window);return r&&e.mockDomain&&0===e.mockDomain.indexOf(P.MOCK_PROTOCOL)?e.mockDomain:r}function c(e){try{if(e===window)return!0}catch(e){}try{var r=Object.getOwnPropertyDescriptor(e,"location");if(r&&!1===r.enumerable)return!1}catch(e){}try{if(n(e)&&a(e))return!0}catch(e){}try{if(s(e)===s(window))return!0}catch(e){}return!1}function l(e){if(!c(e))return!1;try{if(e===window)return!0;if(n(e)&&a(e))return!0;if(u(window)===u(e))return!0}catch(e){}return!1}function f(e){var r=[];try{for(;e.parent!==e;)r.push(e.parent),e=e.parent}catch(e){}return r}function d(e,r){if(!e||!r)return!1;var t=o(r);return t?t===e:-1!==f(r).indexOf(e)}function p(e){var r=[],t=void 0;try{t=e.frames}catch(r){t=e}var n=void 0;try{n=t.length}catch(e){}if(0===n)return r;if(n){for(var o=0;o<n;o++){var i=void 0;try{i=t[o]}catch(e){continue}r.push(i)}return r}for(var a=0;a<100;a++){var s=void 0;try{s=t[a]}catch(e){return r}if(!s)return r;r.push(s)}return r}function h(e){var r=[],t=p(e),n=Array.isArray(t),o=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(o>=t.length)break;i=t[o++]}else{if((o=t.next()).done)break;i=o.value}var a=i;r.push(a);var s=h(a),u=Array.isArray(s),c=0;for(s=u?s:s[Symbol.iterator]();;){var l;if(u){if(c>=s.length)break;l=s[c++]}else{if((c=s.next()).done)break;l=c.value}var f=l;r.push(f)}}return r}function E(e){if(e){try{if(e.top)return e.top}catch(e){}if(o(e)===e)return e;try{if(d(window,e)&&window.top)return window.top}catch(e){}try{if(d(e,window)&&window.top)return window.top}catch(e){}var r=h(e),t=Array.isArray(r),n=0;for(r=t?r:r[Symbol.iterator]();;){var i;if(t){if(n>=r.length)break;i=r[n++]}else{if((n=r.next()).done)break;i=n.value}var a=i;try{if(a.top)return a.top}catch(e){}if(o(a)===a)return a}}}function y(e){var r=E(e);return h(r).concat(r)}function m(e){if(!e.contentWindow)return!0;if(!e.parentNode)return!0;var r=e.ownerDocument;return!(!r||!r.body||r.body.contains(e))}function _(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{if(e===window)return!1}catch(e){return!0}try{if(!e)return!0}catch(e){return!0}try{if(e.closed)return!0}catch(e){return!e||e.message!==C}if(r&&l(e))try{if(e.mockclosed)return!0}catch(e){}try{if(!e.parent||!e.top)return!0}catch(e){}try{(0,A.noop)(e==e)}catch(e){return!0}var t=function(e,r){for(var t=0;t<e.length;t++)try{if(e[t]===r)return t}catch(e){}return-1}(j,e);if(-1!==t){var n=N[t];if(n&&m(n))return!0}return!1}function v(e,r){var t=p(e),n=t,o=Array.isArray(n),i=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(i>=n.length)break;a=n[i++]}else{if((i=n.next()).done)break;a=i.value}var s=a;try{if(l(s)&&s.name===r&&-1!==t.indexOf(s))return s}catch(e){}}try{if(-1!==t.indexOf(e.frames[r]))return e.frames[r]}catch(e){}try{if(-1!==t.indexOf(e[r]))return e[r]}catch(e){}}function S(e,r){var t=v(e,r);if(t)return t;var n=p(e),o=Array.isArray(n),i=0;for(n=o?n:n[Symbol.iterator]();;){var a;if(o){if(i>=n.length)break;a=n[i++]}else{if((i=n.next()).done)break;a=i.value}var s=S(a,r);if(s)return s}}function b(e){var r=i(e=e||window);return r||(o(e)||void 0)}function O(){return Boolean(i(window))}function g(){return Boolean(o(window))}function w(e,r){var t=e,n=Array.isArray(t),o=0;for(t=n?t:t[Symbol.iterator]();;){var i;if(n){if(o>=t.length)break;i=t[o++]}else{if((o=t.next()).done)break;i=o.value}var a=i,s=r,u=Array.isArray(s),c=0;for(s=u?s:s[Symbol.iterator]();;){var l;if(u){if(c>=s.length)break;l=s[c++]}else{if((c=s.next()).done)break;l=c.value}if(a===l)return!0}}return!1}function T(){for(var e=0,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;r;)(r=o(r))&&(e+=1);return e}function R(e){for(var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,t=e,n=0;n<r;n++){if(!t)return;t=o(t)}return t}Object.defineProperty(r,"__esModule",{value:!0}),r.isFileProtocol=function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:window).location.protocol===P.FILE_PROTOCOL},r.isAboutProtocol=n,r.getParent=o,r.getOpener=i,r.canReadFromWindow=a,r.getActualDomain=s,r.getDomain=u,r.isBlankDomain=function(e){try{if(!e.location.href)return!0;if("about:blank"===e.location.href)return!0}catch(e){}return!1},r.isActuallySameDomain=c,r.isSameDomain=l,r.getParents=f,r.isAncestorParent=d,r.getFrames=p,r.getAllChildFrames=h,r.getTop=E,r.getAllFramesInWindow=y,r.isTop=function(e){return e===E(e)},r.isFrameWindowClosed=m,r.isWindowClosed=_,r.linkFrameWindow=function(e){if(function(){for(var e=0;e<N.length;e++)m(N[e])&&(N.splice(e,1),j.splice(e,1));for(var r=0;r<j.length;r++)_(j[r])&&(N.splice(r,1),j.splice(r,1))}(),e&&e.contentWindow)try{j.push(e.contentWindow),N.push(e)}catch(e){}},r.getUserAgent=function(e){return(e=e||window).navigator.mockUserAgent||e.navigator.userAgent},r.getFrameByName=v,r.findChildFrameByName=S,r.findFrameByName=function(e,r){var t=void 0;return(t=v(e,r))?t:S(E(e)||e,r)},r.isParent=function(e,r){var t=o(r);if(t)return t===e;for(var n=p(e),i=Array.isArray(n),a=0,n=i?n:n[Symbol.iterator]();;){var s;if(i){if(a>=n.length)break;s=n[a++]}else{if((a=n.next()).done)break;s=a.value}if(s===r)return!0}return!1},r.isOpener=function(e,r){return e===i(r)},r.getAncestor=b,r.getAncestors=function(e){for(var r=[],t=e;t;)(t=b(t))&&r.push(t);return r},r.isAncestor=function(e,r){var t=b(r);if(t)return t===e;if(r===e)return!1;if(E(r)===r)return!1;for(var n=p(e),o=Array.isArray(n),i=0,n=o?n:n[Symbol.iterator]();;){var a;if(o){if(i>=n.length)break;a=n[i++]}else{if((i=n.next()).done)break;a=i.value}if(a===r)return!0}return!1},r.isPopup=O,r.isIframe=g,r.isFullpage=function(){return Boolean(!g()&&!O())},r.getDistanceFromTop=T,r.getNthParent=R,r.getNthParentFromTop=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return R(e,T(e)-r)},r.isSameTopWindow=function(e,r){var t=E(e)||e,n=E(r)||r;try{if(t&&n)return t===n}catch(e){}var o=y(e),a=y(r);if(w(o,a))return!0;var s=i(t),u=i(n);return(!s||!w(y(s),a))&&(u&&w(y(u),o),!1)},r.matchDomain=function e(r,t){if("string"==typeof r){if("string"==typeof t)return r===P.WILDCARD||t===r;if((0,A.isRegex)(t))return!1;if(Array.isArray(t))return!1}return(0,A.isRegex)(r)?(0,A.isRegex)(t)?r.toString()===t.toString():!Array.isArray(t)&&Boolean(t.match(r)):!!Array.isArray(r)&&(Array.isArray(t)?JSON.stringify(r)===JSON.stringify(t):!(0,A.isRegex)(t)&&r.some(function(r){return e(r,t)}))},r.stringifyDomainPattern=function(e){return Array.isArray(e)?"("+e.join(" | ")+")":(0,A.isRegex)(e)?"RegExp("+e.toString():e.toString()},r.getDomainFromUrl=function(e){var r=void 0;return e.match(/^(https?|mock|file):\/\//)?(r=e,r=r.split("/").slice(0,3).join("/")):u()},r.onCloseWindow=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,o=void 0;return function i(){if(_(e))return o&&clearTimeout(o),r();n<=0?clearTimeout(o):(n-=t,o=setTimeout(i,t))}(),{cancel:function(){o&&clearTimeout(o)}}},r.isWindow=function(e){try{if(e===window)return!0}catch(e){if(e&&e.message===C)return!0}try{if("[object Window]"===Object.prototype.toString.call(e))return!0}catch(e){if(e&&e.message===C)return!0}try{if(window.Window&&e instanceof window.Window)return!0}catch(e){if(e&&e.message===C)return!0}try{if(e&&e.self===e)return!0}catch(e){if(e&&e.message===C)return!0}try{if(e&&e.parent===e)return!0}catch(e){if(e&&e.message===C)return!0}try{if(e&&e.top===e)return!0}catch(e){if(e&&e.message===C)return!0}try{(0,A.noop)(e==e)}catch(e){return!0}try{(0,A.noop)(e&&e.__cross_domain_utils_window_check__)}catch(e){return!0}return!1};var A=t("./node_modules/cross-domain-utils/src/util.js"),P={MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",ABOUT_PROTOCOL:"about:",WILDCARD:"*"},C="Call was rejected by callee.\r\n",j=[],N=[]},"./node_modules/webpack/buildin/global.js":function(e,r,t){"use strict";var n,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":o(window))&&(n=window)}e.exports=n},"./node_modules/zalgo-promise/src/exceptions.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.dispatchPossiblyUnhandledError=function(e){if(-1===(0,n.getGlobal)().dispatchedErrors.indexOf(e)){(0,n.getGlobal)().dispatchedErrors.push(e),setTimeout(function(){throw e},1);for(var r=0;r<(0,n.getGlobal)().possiblyUnhandledPromiseHandlers.length;r++)(0,n.getGlobal)().possiblyUnhandledPromiseHandlers[r](e)}},r.onPossiblyUnhandledException=function(e){return(0,n.getGlobal)().possiblyUnhandledPromiseHandlers.push(e),{cancel:function(){(0,n.getGlobal)().possiblyUnhandledPromiseHandlers.splice((0,n.getGlobal)().possiblyUnhandledPromiseHandlers.indexOf(e),1)}}};var n=t("./node_modules/zalgo-promise/src/global.js")},"./node_modules/zalgo-promise/src/global.js":function(e,r,t){"use strict";(function(e){Object.defineProperty(r,"__esModule",{value:!0}),r.getGlobal=function(){var r=void 0;if("undefined"!=typeof window)r=window;else{if(void 0===e)throw new TypeError("Can not find global");r=e}var t=r.__zalgopromise__=r.__zalgopromise__||{};return t.flushPromises=t.flushPromises||[],t.activeCount=t.activeCount||0,t.possiblyUnhandledPromiseHandlers=t.possiblyUnhandledPromiseHandlers||[],t.dispatchedErrors=t.dispatchedErrors||[],t}}).call(r,t("./node_modules/webpack/buildin/global.js"))},"./node_modules/zalgo-promise/src/index.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./node_modules/zalgo-promise/src/promise.js");Object.defineProperty(r,"ZalgoPromise",{enumerable:!0,get:function(){return n.ZalgoPromise}})},"./node_modules/zalgo-promise/src/promise.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ZalgoPromise=void 0;var n=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),o=t("./node_modules/zalgo-promise/src/utils.js"),i=t("./node_modules/zalgo-promise/src/exceptions.js"),a=t("./node_modules/zalgo-promise/src/global.js"),s=function(){function e(r){var t=this;if(function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],r){var n=void 0,o=void 0,i=!1,a=!1,s=!1;try{r(function(e){s?t.resolve(e):(i=!0,n=e)},function(e){s?t.reject(e):(a=!0,o=e)})}catch(e){return void this.reject(e)}s=!0,i?this.resolve(n):a&&this.reject(o)}}return n(e,[{key:"resolve",value:function(e){if(this.resolved||this.rejected)return this;if((0,o.isPromise)(e))throw new Error("Can not resolve promise with another promise");return this.resolved=!0,this.value=e,this.dispatch(),this}},{key:"reject",value:function(e){var r=this;if(this.resolved||this.rejected)return this;if((0,o.isPromise)(e))throw new Error("Can not reject promise with another promise");if(!e){var t=e&&"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e);e=new Error("Expected reject to be called with Error, got "+t)}return this.rejected=!0,this.error=e,this.errorHandled||setTimeout(function(){r.errorHandled||(0,i.dispatchPossiblyUnhandledError)(e)},1),this.dispatch(),this}},{key:"asyncReject",value:function(e){this.errorHandled=!0,this.reject(e)}},{key:"dispatch",value:function(){var r=this,t=this.dispatching,n=this.resolved,i=this.rejected,s=this.handlers;if(!t&&(n||i)){this.dispatching=!0,(0,a.getGlobal)().activeCount+=1;for(var u=0;u<s.length;u++)!function(t){var a=s[t],u=a.onSuccess,c=a.onError,l=a.promise,f=void 0;if(n)try{f=u?u(r.value):r.value}catch(e){return l.reject(e),"continue"}else if(i){if(!c)return l.reject(r.error),"continue";try{f=c(r.error)}catch(e){return l.reject(e),"continue"}}f instanceof e&&(f.resolved||f.rejected)?(f.resolved?l.resolve(f.value):l.reject(f.error),f.errorHandled=!0):(0,o.isPromise)(f)?f instanceof e&&(f.resolved||f.rejected)?f.resolved?l.resolve(f.value):l.reject(f.error):f.then(function(e){l.resolve(e)},function(e){l.reject(e)}):l.resolve(f)}(u);s.length=0,this.dispatching=!1,(0,a.getGlobal)().activeCount-=1,0===(0,a.getGlobal)().activeCount&&e.flushQueue()}}},{key:"then",value:function(r,t){if(r&&"function"!=typeof r&&!r.call)throw new Error("Promise.then expected a function for success handler");if(t&&"function"!=typeof t&&!t.call)throw new Error("Promise.then expected a function for error handler");var n=new e;return this.handlers.push({promise:n,onSuccess:r,onError:t}),this.errorHandled=!0,this.dispatch(),n}},{key:"catch",value:function(e){return this.then(void 0,e)}},{key:"finally",value:function(r){return this.then(function(t){return e.try(r).then(function(){return t})},function(t){return e.try(r).then(function(){throw t})})}},{key:"timeout",value:function(e,r){var t=this;if(this.resolved||this.rejected)return this;var n=setTimeout(function(){t.resolved||t.rejected||t.reject(r||new Error("Promise timed out after "+e+"ms"))},e);return this.then(function(e){return clearTimeout(n),e})}},{key:"toPromise",value:function(){if("undefined"==typeof Promise)throw new TypeError("Could not find Promise");return Promise.resolve(this)}}],[{key:"resolve",value:function(r){return r instanceof e?r:(0,o.isPromise)(r)?new e(function(e,t){return r.then(e,t)}):(new e).resolve(r)}},{key:"reject",value:function(r){return(new e).reject(r)}},{key:"all",value:function(r){var t=new e,n=r.length,i=[];if(!n)return t.resolve(i),t;for(var a=0;a<r.length;a++)!function(a){var s=r[a];if(s instanceof e){if(s.resolved)return i[a]=s.value,n-=1,"continue"}else if(!(0,o.isPromise)(s))return i[a]=s,n-=1,"continue";e.resolve(s).then(function(e){i[a]=e,0==(n-=1)&&t.resolve(i)},function(e){t.reject(e)})}(a);return 0===n&&t.resolve(i),t}},{key:"hash",value:function(r){var t={};return e.all(Object.keys(r).map(function(n){return e.resolve(r[n]).then(function(e){t[n]=e})})).then(function(){return t})}},{key:"map",value:function(r,t){return e.all(r.map(t))}},{key:"onPossiblyUnhandledException",value:function(e){return(0,i.onPossiblyUnhandledException)(e)}},{key:"try",value:function(r,t,n){var o=void 0;try{o=r.apply(t,n||[])}catch(r){return e.reject(r)}return e.resolve(o)}},{key:"delay",value:function(r){return new e(function(e){setTimeout(e,r)})}},{key:"isPromise",value:function(r){return!!(r&&r instanceof e)||(0,o.isPromise)(r)}},{key:"flush",value:function(){var r=new e;return(0,a.getGlobal)().flushPromises.push(r),0===(0,a.getGlobal)().activeCount&&e.flushQueue(),r}},{key:"flushQueue",value:function(){var e=(0,a.getGlobal)().flushPromises;(0,a.getGlobal)().flushPromises=[];var r=e,t=Array.isArray(r),n=0;for(r=t?r:r[Symbol.iterator]();;){var o;if(t){if(n>=r.length)break;o=r[n++]}else{if((n=r.next()).done)break;o=n.value}o.resolve()}}}]),e}();r.ZalgoPromise=s},"./node_modules/zalgo-promise/src/utils.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isPromise=function(e){try{if(!e)return!1;if("undefined"!=typeof Promise&&e instanceof Promise)return!0;if("undefined"!=typeof window&&window.Window&&e instanceof window.Window)return!1;if("undefined"!=typeof window&&window.constructor&&e instanceof window.constructor)return!1;var r={}.toString;if(r){var t=r.call(e);if("[object Window]"===t||"[object global]"===t||"[object DOMWindow]"===t)return!1}if("function"==typeof e.then)return!0}catch(e){return!1}return!1}},"./src/clean.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.cleanUpWindow=function(e){var r=n.global.requestPromises.get(e);if(r)for(var t=r,o=Array.isArray(t),i=0,t=o?t:t[Symbol.iterator]();;){var a;if(o){if(i>=t.length)break;a=t[i++]}else{if((i=t.next()).done)break;a=i.value}var s=a;s.reject(new Error("No response from window - cleaned up"))}n.global.popupWindowsByWin&&n.global.popupWindowsByWin.delete(e),n.global.remoteWindows&&n.global.remoteWindows.delete(e),n.global.requestPromises.delete(e),n.global.methods.delete(e),n.global.readyPromises.delete(e)},t("./node_modules/cross-domain-utils/src/index.js");var n=t("./src/global.js")},"./src/conf/config.js":function(e,r,t){"use strict";function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}Object.defineProperty(r,"__esModule",{value:!0}),r.CONFIG=void 0;var o,i=t("./src/conf/constants.js"),a=r.CONFIG={ALLOW_POSTMESSAGE_POPUP:!("__ALLOW_POSTMESSAGE_POPUP__"in window)||window.__ALLOW_POSTMESSAGE_POPUP__,LOG_LEVEL:"info",BRIDGE_TIMEOUT:5e3,CHILD_WINDOW_TIMEOUT:5e3,ACK_TIMEOUT:-1!==window.navigator.userAgent.match(/MSIE/i)?2e3:1e3,RES_TIMEOUT:-1,LOG_TO_PAGE:!1,ALLOWED_POST_MESSAGE_METHODS:(o={},n(o,i.CONSTANTS.SEND_STRATEGIES.POST_MESSAGE,!0),n(o,i.CONSTANTS.SEND_STRATEGIES.BRIDGE,!0),n(o,i.CONSTANTS.SEND_STRATEGIES.GLOBAL,!0),o),ALLOW_SAME_ORIGIN:!1};0===window.location.href.indexOf(i.CONSTANTS.FILE_PROTOCOL)&&(a.ALLOW_POSTMESSAGE_POPUP=!0)},"./src/conf/constants.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CONSTANTS={POST_MESSAGE_TYPE:{REQUEST:"postrobot_message_request",RESPONSE:"postrobot_message_response",ACK:"postrobot_message_ack"},POST_MESSAGE_ACK:{SUCCESS:"success",ERROR:"error"},POST_MESSAGE_NAMES:{METHOD:"postrobot_method",HELLO:"postrobot_ready",OPEN_TUNNEL:"postrobot_open_tunnel"},WINDOW_TYPES:{FULLPAGE:"fullpage",POPUP:"popup",IFRAME:"iframe"},WINDOW_PROPS:{POSTROBOT:"__postRobot__"},SERIALIZATION_TYPES:{METHOD:"postrobot_method",ERROR:"postrobot_error",PROMISE:"postrobot_promise",ZALGO_PROMISE:"postrobot_zalgo_promise",REGEX:"regex"},SEND_STRATEGIES:{POST_MESSAGE:"postrobot_post_message",BRIDGE:"postrobot_bridge",GLOBAL:"postrobot_global"},MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",BRIDGE_NAME_PREFIX:"__postrobot_bridge__",POSTROBOT_PROXY:"__postrobot_proxy__",WILDCARD:"*"};var n=r.POST_MESSAGE_NAMES={METHOD:"postrobot_method",HELLO:"postrobot_hello",OPEN_TUNNEL:"postrobot_open_tunnel"};r.POST_MESSAGE_NAMES_LIST=Object.keys(n).map(function(e){return n[e]})},"./src/conf/index.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./src/conf/config.js");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})});var o=t("./src/conf/constants.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}})})},"./src/drivers/index.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./src/drivers/receive/index.js");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})});var o=t("./src/drivers/send/index.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}})});var i=t("./src/drivers/listeners.js");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}})})},"./src/drivers/listeners.js":function(e,r,t){"use strict";function n(e){var r=e.name,t=e.win,n=e.domain;if(t===u.CONSTANTS.WILDCARD&&(t=null),n===u.CONSTANTS.WILDCARD&&(n=null),!r)throw new Error("Name required to get request listener");var o=a.global.requestListeners[r];if(o)for(var s=[t,a.global.WINDOW_WILDCARD],l=0;l<s.length;l++){var f=s[l],d=f&&o.get(f);if(d){if(n&&"string"==typeof n){if(d[n])return d[n];if(d[c]){var p=d[c],h=Array.isArray(p),E=0;for(p=h?p:p[Symbol.iterator]();;){var y;if(h){if(E>=p.length)break;y=p[E++]}else{if((E=p.next()).done)break;y=E.value}var m=y,_=m.regex,v=m.listener;if((0,i.matchDomain)(_,n))return v}}}if(d[u.CONSTANTS.WILDCARD])return d[u.CONSTANTS.WILDCARD]}}}Object.defineProperty(r,"__esModule",{value:!0}),r.resetListeners=function(){a.global.responseListeners={},a.global.requestListeners={}},r.addResponseListener=function(e,r){a.global.responseListeners[e]=r},r.getResponseListener=function(e){return a.global.responseListeners[e]},r.deleteResponseListener=function(e){delete a.global.responseListeners[e]},r.markResponseListenerErrored=function(e){a.global.erroredResponseListeners[e]=!0},r.isResponseListenerErrored=function(e){return Boolean(a.global.erroredResponseListeners[e])},r.getRequestListener=n,r.addRequestListener=function e(r,t){var i=r.name,l=r.win,f=r.domain;if(!i||"string"!=typeof i)throw new Error("Name required to add request listener");if(Array.isArray(l)){for(var d=[],p=l,h=Array.isArray(p),E=0,p=h?p:p[Symbol.iterator]();;){var y;if(h){if(E>=p.length)break;y=p[E++]}else{if((E=p.next()).done)break;y=E.value}var m=y;d.push(e({name:i,domain:f,win:m},t))}return{cancel:function(){for(var e=d,r=Array.isArray(e),t=0,e=r?e:e[Symbol.iterator]();;){var n;if(r){if(t>=e.length)break;n=e[t++]}else{if((t=e.next()).done)break;n=t.value}n.cancel()}}}}if(Array.isArray(f)){for(var _=[],v=f,S=Array.isArray(v),b=0,v=S?v:v[Symbol.iterator]();;){var O;if(S){if(b>=v.length)break;O=v[b++]}else{if((b=v.next()).done)break;O=b.value}var g=O;_.push(e({name:i,win:l,domain:g},t))}return{cancel:function(){for(var e=_,r=Array.isArray(e),t=0,e=r?e:e[Symbol.iterator]();;){var n;if(r){if(t>=e.length)break;n=e[t++]}else{if((t=e.next()).done)break;n=t.value}n.cancel()}}}}var w=n({name:i,win:l,domain:f});if(l&&l!==u.CONSTANTS.WILDCARD||(l=a.global.WINDOW_WILDCARD),f=f||u.CONSTANTS.WILDCARD,w)throw l&&f?new Error("Request listener already exists for "+i+" on domain "+f.toString()+" for "+(l===a.global.WINDOW_WILDCARD?"wildcard":"specified")+" window"):l?new Error("Request listener already exists for "+i+" for "+(l===a.global.WINDOW_WILDCARD?"wildcard":"specified")+" window"):f?new Error("Request listener already exists for "+i+" on domain "+f.toString()):new Error("Request listener already exists for "+i);var T=a.global.requestListeners,R=T[i];R||(R=new o.WeakMap,T[i]=R);var A=R.get(l);A||(A={},R.set(l,A));var P=f.toString(),C=A[c],j=void 0;return(0,s.isRegex)(f)?(C||(C=[],A[c]=C),j={regex:f,listener:t},C.push(j)):A[P]=t,{cancel:function(){A&&(delete A[P],l&&0===Object.keys(A).length&&R.delete(l),j&&C.splice(C.indexOf(j,1)))}}},t("./node_modules/zalgo-promise/src/index.js");var o=t("./node_modules/cross-domain-safe-weakmap/src/index.js"),i=t("./node_modules/cross-domain-utils/src/index.js"),a=t("./src/global.js"),s=t("./src/lib/index.js"),u=t("./src/conf/index.js");a.global.responseListeners=a.global.responseListeners||{},a.global.requestListeners=a.global.requestListeners||{},a.global.WINDOW_WILDCARD=a.global.WINDOW_WILDCARD||new function(){},a.global.erroredResponseListeners=a.global.erroredResponseListeners||{};var c="__domain_regex__"},"./src/drivers/receive/index.js":function(e,r,t){"use strict";function n(e){if(!window||window.closed)throw new Error("Message recieved in closed window");try{if(!e.source)return}catch(e){return}var r=e.source,t=e.origin,n=function(e){var r=void 0;try{r=(0,u.jsonParse)(e)}catch(e){return}if(r&&"object"===(void 0===r?"undefined":i(r))&&null!==r&&(r=r[s.CONSTANTS.WINDOW_PROPS.POSTROBOT])&&"object"===(void 0===r?"undefined":i(r))&&null!==r&&r.type&&"string"==typeof r.type&&l.RECEIVE_MESSAGE_TYPES[r.type])return r}(e.data);if(n){if(!n.sourceDomain||"string"!=typeof n.sourceDomain)throw new Error("Expected message to have sourceDomain");if(0!==n.sourceDomain.indexOf(s.CONSTANTS.MOCK_PROTOCOL)&&0!==n.sourceDomain.indexOf(s.CONSTANTS.FILE_PROTOCOL)||(t=n.sourceDomain),-1===c.global.receivedMessages.indexOf(n.id)){c.global.receivedMessages.push(n.id);var o=void 0;o=-1!==s.POST_MESSAGE_NAMES_LIST.indexOf(n.name)||n.type===s.CONSTANTS.POST_MESSAGE_TYPE.ACK?"debug":"error"===n.ack?"error":"info",u.log.logLevel(o,["\n\n\t","#receive",n.type.replace(/^postrobot_message_/,""),"::",n.name,"::",t,"\n\n",n]),!(0,a.isWindowClosed)(r)||n.fireAndForget?(n.data&&(n.data=(0,u.deserializeMethods)(r,t,n.data)),l.RECEIVE_MESSAGE_TYPES[n.type](r,t,n)):u.log.debug("Source window is closed - can not send "+n.type+" "+n.name)}}}function o(e){try{(0,u.noop)(e.source)}catch(e){return}n({source:e.source||e.sourceElement,origin:e.origin||e.originalEvent&&e.originalEvent.origin,data:e.data})}Object.defineProperty(r,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.receiveMessage=n,r.messageListener=o,r.listenForMessages=function(){(0,u.addEventListener)(window,"message",o)};var a=t("./node_modules/cross-domain-utils/src/index.js"),s=t("./src/conf/index.js"),u=t("./src/lib/index.js"),c=t("./src/global.js"),l=t("./src/drivers/receive/types.js");c.global.receivedMessages=c.global.receivedMessages||[],c.global.receiveMessage=n},"./src/drivers/receive/types.js":function(e,r,t){"use strict";function n(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}Object.defineProperty(r,"__esModule",{value:!0}),r.RECEIVE_MESSAGE_TYPES=void 0;var o,i=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},a=t("./node_modules/zalgo-promise/src/index.js"),s=t("./node_modules/cross-domain-utils/src/index.js"),u=t("./src/conf/index.js"),c=t("./src/lib/index.js"),l=t("./src/drivers/send/index.js"),f=t("./src/drivers/listeners.js");r.RECEIVE_MESSAGE_TYPES=(n(o={},u.CONSTANTS.POST_MESSAGE_TYPE.ACK,function(e,r,t){if(!(0,f.isResponseListenerErrored)(t.hash)){var n=(0,f.getResponseListener)(t.hash);if(!n)throw new Error("No handler found for post message ack for message: "+t.name+" from "+r+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!(0,s.matchDomain)(n.domain,r))throw new Error("Ack origin "+r+" does not match domain "+n.domain.toString());n.ack=!0}}),n(o,u.CONSTANTS.POST_MESSAGE_TYPE.REQUEST,function(e,r,t){function n(n){return t.fireAndForget||(0,s.isWindowClosed)(e)?a.ZalgoPromise.resolve():(0,l.sendMessage)(e,i({target:t.originalSource,hash:t.hash,name:t.name},n),r)}var o=(0,f.getRequestListener)({name:t.name,win:e,domain:r});return a.ZalgoPromise.all([n({type:u.CONSTANTS.POST_MESSAGE_TYPE.ACK}),a.ZalgoPromise.try(function(){if(!o)throw new Error("No handler found for post message: "+t.name+" from "+r+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!(0,s.matchDomain)(o.domain,r))throw new Error("Request origin "+r+" does not match domain "+o.domain.toString());var n=t.data;return o.handler({source:e,origin:r,data:n})}).then(function(e){return n({type:u.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,ack:u.CONSTANTS.POST_MESSAGE_ACK.SUCCESS,data:e})},function(e){var r=(0,c.stringifyError)(e).replace(/^Error: /,""),t=e.code;return n({type:u.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,ack:u.CONSTANTS.POST_MESSAGE_ACK.ERROR,error:r,code:t})})]).then(c.noop).catch(function(e){if(o&&o.handleError)return o.handleError(e);c.log.error((0,c.stringifyError)(e))})}),n(o,u.CONSTANTS.POST_MESSAGE_TYPE.RESPONSE,function(e,r,t){if(!(0,f.isResponseListenerErrored)(t.hash)){var n=(0,f.getResponseListener)(t.hash);if(!n)throw new Error("No handler found for post message response for message: "+t.name+" from "+r+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!(0,s.matchDomain)(n.domain,r))throw new Error("Response origin "+r+" does not match domain "+(0,s.stringifyDomainPattern)(n.domain));if((0,f.deleteResponseListener)(t.hash),t.ack===u.CONSTANTS.POST_MESSAGE_ACK.ERROR){var o=new Error(t.error);return t.code&&(o.code=t.code),n.respond(o,null)}if(t.ack===u.CONSTANTS.POST_MESSAGE_ACK.SUCCESS){var i=t.data||t.response;return n.respond(null,{source:e,origin:r,data:i})}}}),o)},"./src/drivers/send/index.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};r.sendMessage=function(e,r,t){return i.ZalgoPromise.try(function(){r=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=(0,s.uniqueID)(),a=(0,s.getWindowType)(),u=(0,o.getDomain)(window);return n({},r,t,{sourceDomain:u,id:r.id||i,windowType:a})}(e,r,{data:(0,s.serializeMethods)(e,t,r.data),domain:t});var c=void 0;if(c=-1!==a.POST_MESSAGE_NAMES_LIST.indexOf(r.name)||r.type===a.CONSTANTS.POST_MESSAGE_TYPE.ACK?"debug":"error"===r.ack?"error":"info",s.log.logLevel(c,["\n\n\t","#send",r.type.replace(/^postrobot_message_/,""),"::",r.name,"::",t||a.CONSTANTS.WILDCARD,"\n\n",r]),e===window&&!a.CONFIG.ALLOW_SAME_ORIGIN)throw new Error("Attemping to send message to self");if((0,o.isWindowClosed)(e))throw new Error("Window is closed");s.log.debug("Running send message strategies",r);var l=[],f=(0,s.jsonStringify)(function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}({},a.CONSTANTS.WINDOW_PROPS.POSTROBOT,r),null,2);return i.ZalgoPromise.map(Object.keys(u.SEND_MESSAGE_STRATEGIES),function(r){return i.ZalgoPromise.try(function(){if(!a.CONFIG.ALLOWED_POST_MESSAGE_METHODS[r])throw new Error("Strategy disallowed: "+r);return u.SEND_MESSAGE_STRATEGIES[r](e,f,t)}).then(function(){return l.push(r+": success"),!0},function(e){return l.push(r+": "+(0,s.stringifyError)(e)+"\n"),!1})}).then(function(e){var t=e.some(Boolean),n=r.type+" "+r.name+" "+(t?"success":"error")+":\n  - "+l.join("\n  - ")+"\n";if(s.log.debug(n),!t)throw new Error(n)})})};var o=t("./node_modules/cross-domain-utils/src/index.js"),i=t("./node_modules/zalgo-promise/src/index.js"),a=t("./src/conf/index.js"),s=t("./src/lib/index.js"),u=t("./src/drivers/send/strategies.js")},"./src/drivers/send/strategies.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.SEND_MESSAGE_STRATEGIES=void 0;var n=t("./node_modules/cross-domain-utils/src/index.js"),o=t("./src/conf/index.js");(r.SEND_MESSAGE_STRATEGIES={})[o.CONSTANTS.SEND_STRATEGIES.POST_MESSAGE]=function(e,r,t){(Array.isArray(t)?t:"string"==typeof t?[t]:[o.CONSTANTS.WILDCARD]).map(function(r){if(0===r.indexOf(o.CONSTANTS.MOCK_PROTOCOL)){if(window.location.protocol===o.CONSTANTS.FILE_PROTOCOL)return o.CONSTANTS.WILDCARD;if(!(0,n.isActuallySameDomain)(e))throw new Error("Attempting to send messsage to mock domain "+r+", but window is actually cross-domain");return(0,n.getActualDomain)(e)}return 0===r.indexOf(o.CONSTANTS.FILE_PROTOCOL)?o.CONSTANTS.WILDCARD:r}).forEach(function(t){return e.postMessage(r,t)})}},"./src/global.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.global=void 0;var n=t("./src/conf/index.js");(r.global=window[n.CONSTANTS.WINDOW_PROPS.POSTROBOT]=window[n.CONSTANTS.WINDOW_PROPS.POSTROBOT]||{}).registerSelf=function(){}},"./src/index.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./src/interface.js");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})});var o=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}(n);r.default=o},"./src/interface.js":function(e,r,t){"use strict";function n(){c.global.initialized||((0,u.listenForMessages)(),(0,s.initOnReady)(),(0,s.listenForMethods)({on:o.on,send:o.send})),c.global.initialized=!0}Object.defineProperty(r,"__esModule",{value:!0}),r.bridge=r.Promise=r.cleanUpWindow=void 0;var o=t("./src/public/index.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}})});var i=t("./src/clean.js");Object.defineProperty(r,"cleanUpWindow",{enumerable:!0,get:function(){return i.cleanUpWindow}});var a=t("./node_modules/zalgo-promise/src/index.js");Object.defineProperty(r,"Promise",{enumerable:!0,get:function(){return a.ZalgoPromise}}),r.init=n;var s=t("./src/lib/index.js"),u=t("./src/drivers/index.js"),c=t("./src/global.js");r.bridge=null,n()},"./src/lib/index.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t("./src/lib/util.js");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})});var o=t("./src/lib/log.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}})});var i=t("./src/lib/serialize.js");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}})});var a=t("./src/lib/ready.js");Object.keys(a).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return a[e]}})})},"./src/lib/log.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.log=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=t("./src/conf/index.js"),i=t("./src/lib/util.js"),a=["debug","info","warn","error"];Function.prototype.bind&&window.console&&"object"===n(console.log)&&["log","info","warn","error"].forEach(function(e){console[e]=this.bind(console[e],console)},Function.prototype.call);var s=r.log={clearLogs:function(){if(window.console&&window.console.clear&&window.console.clear(),o.CONFIG.LOG_TO_PAGE){var e=document.getElementById("postRobotLogs");e&&e.parentNode&&e.parentNode.removeChild(e)}},writeToPage:function(e,r){setTimeout(function(){var t=document.getElementById("postRobotLogs");t||((t=document.createElement("div")).id="postRobotLogs",t.style.cssText="width: 800px; font-family: monospace; white-space: pre-wrap;",document.body&&document.body.appendChild(t));var n=document.createElement("div"),o=(new Date).toString().split(" ")[4],a=Array.prototype.slice.call(r).map(function(e){if("string"==typeof e)return e;if(!e)return Object.prototype.toString.call(e);var r=void 0;try{r=(0,i.jsonStringify)(e,null,2)}catch(e){r="[object]"}return"\n\n"+r+"\n\n"}).join(" "),s=o+" "+e+" "+a;n.innerHTML=s;var u={log:"#ddd",warn:"orange",error:"red",info:"blue",debug:"#aaa"}[e];n.style.cssText="margin-top: 10px; color: "+u+";",t.childNodes.length?t.insertBefore(n,t.childNodes[0]):t.appendChild(n)})},logLevel:function(e,r){setTimeout(function(){try{var t=window.LOG_LEVEL||o.CONFIG.LOG_LEVEL;if("disabled"===t||a.indexOf(e)<a.indexOf(t))return;if((r=Array.prototype.slice.call(r)).unshift(""+window.location.host+window.location.pathname),r.unshift("::"),r.unshift(""+(0,i.getWindowType)().toLowerCase()),r.unshift("[post-robot]"),o.CONFIG.LOG_TO_PAGE&&s.writeToPage(e,r),!window.console)return;if(window.console[e]||(e="log"),!window.console[e])return;window.console[e].apply(window.console,r)}catch(e){}},1)},debug:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];s.logLevel("debug",r)},info:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];s.logLevel("info",r)},warn:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];s.logLevel("warn",r)},error:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];s.logLevel("error",r)}}},"./src/lib/ready.js":function(e,r,t){"use strict";function n(e){c.global.on(u.CONSTANTS.POST_MESSAGE_NAMES.HELLO,{domain:u.CONSTANTS.WILDCARD},function(r){var t=r.source,n=r.origin;return e({source:t,origin:n})})}function o(e){return c.global.send(e,u.CONSTANTS.POST_MESSAGE_NAMES.HELLO,{},{domain:u.CONSTANTS.WILDCARD,timeout:-1}).then(function(e){return{origin:e.origin}})}Object.defineProperty(r,"__esModule",{value:!0}),r.onHello=n,r.sayHello=o,r.initOnReady=function(){n(function(e){var r=e.source,t=e.origin,n=c.global.readyPromises.get(r)||new s.ZalgoPromise;n.resolve({origin:t}),c.global.readyPromises.set(r,n)});var e=(0,a.getAncestor)();e&&o(e).catch(function(e){l.log.debug((0,f.stringifyError)(e))})},r.onChildWindowReady=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Window",n=c.global.readyPromises.get(e);return n||(n=new s.ZalgoPromise,c.global.readyPromises.set(e,n),-1!==r&&setTimeout(function(){return n.reject(new Error(t+" did not load after "+r+"ms"))},r),n)};var i=t("./node_modules/cross-domain-safe-weakmap/src/index.js"),a=t("./node_modules/cross-domain-utils/src/index.js"),s=t("./node_modules/zalgo-promise/src/index.js"),u=t("./src/conf/index.js"),c=t("./src/global.js"),l=t("./src/lib/log.js"),f=t("./src/lib/util.js");c.global.readyPromises=c.global.readyPromises||new i.WeakMap},"./src/lib/serialize.js":function(e,r,t){"use strict";function n(e,r){return"object"===(void 0===e?"undefined":l(e))&&null!==e&&e.__type__===r}function o(e,r,t,n){var o=(0,y.uniqueID)(),i=E.global.methods.get(e);return i||(i={},E.global.methods.set(e,i)),i[o]={domain:r,method:t},{__type__:h.CONSTANTS.SERIALIZATION_TYPES.METHOD,__id__:o,__name__:n}}function i(e,r,t){function n(){var n=Array.prototype.slice.call(arguments);return m.log.debug("Call foreign method",t.__name__,n),E.global.send(e,h.CONSTANTS.POST_MESSAGE_NAMES.METHOD,{id:t.__id__,name:t.__name__,args:n},{domain:r,timeout:-1}).then(function(e){var r=e.data;return m.log.debug("Got foreign method result",t.__name__,r.result),r.result},function(e){throw m.log.debug("Got foreign method error",(0,y.stringifyError)(e)),e})}return n.__name__=t.__name__,n.__xdomain__=!0,n.source=e,n.origin=r,n}function a(e,r,t){var n=new Error(t.__message__);return t.__code__&&(n.code=t.__code__),n}function s(e,r,t){return new p.ZalgoPromise(function(n,o){return i(e,r,t.__then__)(n,o)})}function u(e,r,t){return window.Promise?new window.Promise(function(n,o){return i(e,r,t.__then__)(n,o)}):s(e,r,t)}function c(e,r,t){return new RegExp(t.__source__)}Object.defineProperty(r,"__esModule",{value:!0}),r.listenForMethods=void 0;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.serializeMethod=o,r.serializeMethods=function(e,r,t){return(0,y.replaceObject)({obj:t},function(t,n){return"function"==typeof t?o(e,r,t,n.toString()):t instanceof Error?(i=t,{__type__:h.CONSTANTS.SERIALIZATION_TYPES.ERROR,__message__:(0,y.stringifyError)(i),__code__:i.code}):window.Promise&&t instanceof window.Promise?function(e,r,t,n){return{__type__:h.CONSTANTS.SERIALIZATION_TYPES.PROMISE,__then__:o(e,r,function(e,r){return t.then(e,r)},n+".then")}}(e,r,t,n.toString()):p.ZalgoPromise.isPromise(t)?function(e,r,t,n){return{__type__:h.CONSTANTS.SERIALIZATION_TYPES.ZALGO_PROMISE,__then__:o(e,r,function(e,r){return t.then(e,r)},n+".then")}}(e,r,t,n.toString()):(0,y.isRegex)(t)?(a=t,{__type__:h.CONSTANTS.SERIALIZATION_TYPES.REGEX,__source__:a.source}):void 0;var i,a}).obj},r.deserializeMethod=i,r.deserializeError=a,r.deserializeZalgoPromise=s,r.deserializePromise=u,r.deserializeRegex=c,r.deserializeMethods=function(e,r,t){return(0,y.replaceObject)({obj:t},function(t){if("object"===(void 0===t?"undefined":l(t))&&null!==t)return n(t,h.CONSTANTS.SERIALIZATION_TYPES.METHOD)?i(e,r,t):n(t,h.CONSTANTS.SERIALIZATION_TYPES.ERROR)?a(e,r,t):n(t,h.CONSTANTS.SERIALIZATION_TYPES.PROMISE)?u(e,r,t):n(t,h.CONSTANTS.SERIALIZATION_TYPES.ZALGO_PROMISE)?s(e,r,t):n(t,h.CONSTANTS.SERIALIZATION_TYPES.REGEX)?c(e,r,t):void 0}).obj};var f=t("./node_modules/cross-domain-safe-weakmap/src/index.js"),d=t("./node_modules/cross-domain-utils/src/index.js"),p=t("./node_modules/zalgo-promise/src/index.js"),h=t("./src/conf/index.js"),E=t("./src/global.js"),y=t("./src/lib/util.js"),m=t("./src/lib/log.js");E.global.methods=E.global.methods||new f.WeakMap,r.listenForMethods=(0,y.once)(function(){E.global.on(h.CONSTANTS.POST_MESSAGE_NAMES.METHOD,{origin:h.CONSTANTS.WILDCARD},function(e){var r=e.source,t=e.origin,n=e.data,o=E.global.methods.get(r);if(!o)throw new Error("Could not find any methods this window has privileges to call");var i=o[n.id];if(!i)throw new Error("Could not find method with id: "+n.id);if(!(0,d.matchDomain)(i.domain,t))throw new Error("Method domain "+i.domain+" does not match origin "+t);return m.log.debug("Call local method",n.name,n.args),p.ZalgoPromise.try(function(){return i.method.apply({source:r,origin:t,data:n},n.args)}).then(function(e){return{result:e,id:n.id,name:n.name}})})})},"./src/lib/util.js":function(e,r,t){"use strict";function n(e,r){for(var t=0;t<e.length;t++)r(e[t],t)}function o(e,r){for(var t in e)e.hasOwnProperty(t)&&r(e[t],t)}function i(e,r){Array.isArray(e)?n(e,r):"object"===(void 0===e?"undefined":a(e))&&null!==e&&o(e,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.weakMapMemoize=r.once=void 0;var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.stringifyError=function e(r){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(t>=3)return"stringifyError stack overflow";try{if(!r)return"<unknown error: "+Object.prototype.toString.call(r)+">";if("string"==typeof r)return r;if(r instanceof Error){var n=r&&r.stack,o=r&&r.message;if(n&&o)return-1!==n.indexOf(o)?n:o+"\n"+n;if(n)return n;if(o)return o}return"function"==typeof r.toString?r.toString():Object.prototype.toString.call(r)}catch(r){return"Error while stringifying error: "+e(r,t+1)}},r.noop=function(){},r.addEventListener=function(e,r,t){return e.addEventListener?e.addEventListener(r,t):e.attachEvent("on"+r,t),{cancel:function(){e.removeEventListener?e.removeEventListener(r,t):e.detachEvent("on"+r,t)}}},r.uniqueID=function(){var e="0123456789abcdef";return"xxxxxxxxxx".replace(/./g,function(){return e.charAt(Math.floor(Math.random()*e.length))})},r.eachArray=n,r.eachObject=o,r.each=i,r.replaceObject=function e(r,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(n>=100)throw new Error("Self-referential object passed, or object contained too many layers");var o=void 0;if("object"!==(void 0===r?"undefined":a(r))||null===r||Array.isArray(r)){if(!Array.isArray(r))throw new TypeError("Invalid type: "+(void 0===r?"undefined":a(r)));o=[]}else o={};return i(r,function(r,i){var s=t(r,i);void 0!==s?o[i]=s:"object"===(void 0===r?"undefined":a(r))&&null!==r?o[i]=e(r,t,n+1):o[i]=r}),o},r.safeInterval=function(e,r){var t=void 0;return t=setTimeout(function n(){t=setTimeout(n,r),e.call()},r),{cancel:function(){clearTimeout(t)}}},r.isRegex=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},r.getWindowType=function(){return(0,u.isPopup)()?c.CONSTANTS.WINDOW_TYPES.POPUP:(0,u.isIframe)()?c.CONSTANTS.WINDOW_TYPES.IFRAME:c.CONSTANTS.WINDOW_TYPES.FULLPAGE},r.jsonStringify=function(e,r,t){var n=void 0,o=void 0;try{if("{}"!==JSON.stringify({})&&(n=Object.prototype.toJSON,delete Object.prototype.toJSON),"{}"!==JSON.stringify({}))throw new Error("Can not correctly serialize JSON objects");if("[]"!==JSON.stringify([])&&(o=Array.prototype.toJSON,delete Array.prototype.toJSON),"[]"!==JSON.stringify([]))throw new Error("Can not correctly serialize JSON objects")}catch(e){throw new Error("Can not repair JSON.stringify: "+e.message)}var i=JSON.stringify.call(this,e,r,t);try{n&&(Object.prototype.toJSON=n),o&&(Array.prototype.toJSON=o)}catch(e){throw new Error("Can not repair JSON.stringify: "+e.message)}return i},r.jsonParse=function(e){return JSON.parse(e)};var s=t("./node_modules/cross-domain-safe-weakmap/src/index.js"),u=t("./node_modules/cross-domain-utils/src/index.js"),c=t("./src/conf/index.js");r.once=function(e){if(!e)return e;var r=!1;return function(){if(!r)return r=!0,e.apply(this,arguments)}},r.weakMapMemoize=function(e){var r=new s.WeakMap;return function(t){var n=r.get(t);return void 0!==n?n:(void 0!==(n=e.call(this,t))&&r.set(t,n),n)}}},"./src/public/client.js":function(e,r,t){"use strict";function n(e){return a.ZalgoPromise.try(function(){if(!e.name)throw new Error("Expected options.name");var r=e.name,t=void 0,n=void 0;if("string"==typeof e.window){var o=document.getElementById(e.window);if(!o)throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be a valid element id");if("iframe"!==o.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be an iframe");if(!o.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");t=o.contentWindow}else if(e.window instanceof HTMLIFrameElement){if("iframe"!==e.window.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(e.window)+" to be an iframe");if(e.window&&!e.window.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");e.window&&e.window.contentWindow&&(t=e.window.contentWindow)}else t=e.window;if(!t)throw new Error("Expected options.window to be a window object, iframe, or iframe element id.");var i=t;n=e.domain||u.CONSTANTS.WILDCARD;var d=e.name+"_"+(0,l.uniqueID)();if((0,s.isWindowClosed)(i))throw new Error("Target window is closed");var p=!1,h=f.global.requestPromises.get(i);h||(h=[],f.global.requestPromises.set(i,h));var E=a.ZalgoPromise.try(function(){if((0,s.isAncestor)(window,i))return(0,l.onChildWindowReady)(i,e.timeout||u.CONFIG.CHILD_WINDOW_TIMEOUT)}).then(function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).origin;if((0,l.isRegex)(n)&&!e)return(0,l.sayHello)(i)}).then(function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).origin;if((0,l.isRegex)(n)){if(!(0,s.matchDomain)(n,t))throw new Error("Remote window domain "+t+" does not match regex: "+n.toString());n=t}if("string"!=typeof n&&!Array.isArray(n))throw new TypeError("Expected domain to be a string or array");var o=n;return new a.ZalgoPromise(function(t,n){var a=void 0;if(e.fireAndForget||(a={name:r,window:i,domain:o,respond:function(e,r){e||(p=!0,h.splice(h.indexOf(E,1))),e?n(e):t(r)}},(0,c.addResponseListener)(d,a)),(0,c.sendMessage)(i,{type:u.CONSTANTS.POST_MESSAGE_TYPE.REQUEST,hash:d,name:r,data:e.data,fireAndForget:e.fireAndForget},o).catch(n),e.fireAndForget)return t();var l=u.CONFIG.ACK_TIMEOUT,f=e.timeout||u.CONFIG.RES_TIMEOUT,y=100;setTimeout(function t(){if(!p){if((0,s.isWindowClosed)(i))return n(a.ack?new Error("Window closed for "+r+" before response"):new Error("Window closed for "+r+" before ack"));if(l=Math.max(l-y,0),-1!==f&&(f=Math.max(f-y,0)),a.ack){if(-1===f)return;y=Math.min(f,2e3)}else{if(0===l)return n(new Error("No ack for postMessage "+r+" in "+(0,s.getDomain)()+" in "+u.CONFIG.ACK_TIMEOUT+"ms"));if(0===f)return n(new Error("No response for postMessage "+r+" in "+(0,s.getDomain)()+" in "+(e.timeout||u.CONFIG.RES_TIMEOUT)+"ms"))}setTimeout(t,y)}},y)})});return E.catch(function(){(0,c.markResponseListenerErrored)(d),(0,c.deleteResponseListener)(d)}),h.push(E),E})}function o(e,r,t,o){return(o=o||{}).window=e,o.name=r,o.data=t,n(o)}Object.defineProperty(r,"__esModule",{value:!0}),r.send=void 0,r.request=n,r.sendToParent=function(e,r,t){var n=(0,s.getAncestor)();return n?o(n,e,r,t):new a.ZalgoPromise(function(e,r){return r(new Error("Window does not have a parent"))})},r.client=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.window)throw new Error("Expected options.window");var r=e.window;return{send:function(t,n){return o(r,t,n,e)}}};var i=t("./node_modules/cross-domain-safe-weakmap/src/index.js"),a=t("./node_modules/zalgo-promise/src/index.js"),s=t("./node_modules/cross-domain-utils/src/index.js"),u=t("./src/conf/index.js"),c=t("./src/drivers/index.js"),l=t("./src/lib/index.js"),f=t("./src/global.js");f.global.requestPromises=f.global.requestPromises||new i.WeakMap,r.send=o,f.global.send=o},"./src/public/config.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CONSTANTS=r.CONFIG=void 0;var n=t("./src/conf/index.js");Object.defineProperty(r,"CONFIG",{enumerable:!0,get:function(){return n.CONFIG}}),Object.defineProperty(r,"CONSTANTS",{enumerable:!0,get:function(){return n.CONSTANTS}}),r.disable=function(){delete window[n.CONSTANTS.WINDOW_PROPS.POSTROBOT],window.removeEventListener("message",o.messageListener)};var o=t("./src/drivers/index.js")},"./src/public/index.js":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.parent=void 0;var n=t("./src/public/client.js");Object.keys(n).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return n[e]}})});var o=t("./src/public/server.js");Object.keys(o).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return o[e]}})});var i=t("./src/public/config.js");Object.keys(i).forEach(function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(r,e,{enumerable:!0,get:function(){return i[e]}})});var a=t("./node_modules/cross-domain-utils/src/index.js");r.parent=(0,a.getAncestor)()},"./src/public/server.js":function(e,r,t){"use strict";function n(e){if(!e.name)throw new Error("Expected options.name");if(!e.handler)throw new Error("Expected options.handler");var r=e.name,t=e.window,n=e.domain,o={handler:e.handler,handleError:e.errorHandler||function(e){throw e},window:t,domain:n||l.CONSTANTS.WILDCARD,name:r},s=(0,c.addRequestListener)({name:r,win:t,domain:n},o);if(e.once){var f=o.handler;o.handler=(0,u.once)(function(){return s.cancel(),f.apply(this,arguments)})}if(o.window&&e.errorOnClose)var d=(0,u.safeInterval)(function(){t&&"object"===(void 0===t?"undefined":i(t))&&(0,a.isWindowClosed)(t)&&(d.cancel(),o.handleError(new Error("Post message target window is closed")))},50);return{cancel:function(){s.cancel()}}}function o(e,r,t){return"function"==typeof r&&(t=r,r={}),(r=r||{}).name=e,r.handler=t||r.handler,n(r)}Object.defineProperty(r,"__esModule",{value:!0}),r.on=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.listen=n,r.once=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments[2];"function"==typeof r&&(t=r,r={}),r=r||{},t=t||r.handler;var o=r.errorHandler,i=new s.ZalgoPromise(function(n,i){(r=r||{}).name=e,r.once=!0,r.handler=function(e){if(n(e),t)return t(e)},r.errorHandler=function(e){if(i(e),o)return o(e)}}),a=n(r);return i.cancel=a.cancel,i},r.listener=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{on:function(r,t){return o(r,e,t)}}};var a=t("./node_modules/cross-domain-utils/src/index.js"),s=t("./node_modules/zalgo-promise/src/index.js"),u=t("./src/lib/index.js"),c=t("./src/drivers/index.js"),l=t("./src/conf/index.js"),f=t("./src/global.js");r.on=o,f.global.on=o}})})},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(e,r){return e?e+"."+r:r};r.buildName=n},function(e,r){!function(e){"use strict";function r(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function t(e){return"string"!=typeof e&&(e=String(e)),e}function n(e){var r={next:function(){var r=e.shift();return{done:void 0===r,value:r}}};return m.iterable&&(r[Symbol.iterator]=function(){return r}),r}function o(e){this.map={},e instanceof o?e.forEach(function(e,r){this.append(r,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(r){this.append(r,e[r])},this)}function i(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function a(e){return new Promise(function(r,t){e.onload=function(){r(e.result)},e.onerror=function(){t(e.error)}})}function s(e){var r=new FileReader,t=a(r);return r.readAsArrayBuffer(e),t}function u(e){var r=new FileReader,t=a(r);return r.readAsText(e),t}function c(e){for(var r=new Uint8Array(e),t=new Array(r.length),n=0;n<r.length;n++)t[n]=String.fromCharCode(r[n]);return t.join("")}function l(e){if(e.slice)return e.slice(0);var r=new Uint8Array(e.byteLength);return r.set(new Uint8Array(e)),r.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(m.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(m.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(m.arrayBuffer&&m.blob&&v(e))this._bodyArrayBuffer=l(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!m.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!S(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},m.blob&&(this.blob=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?i(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(h)}),this.json=function(){return this.text().then(JSON.parse)},this}function d(e){var r=e.toUpperCase();return b.indexOf(r)>-1?r:e}function p(e,r){r=r||{};var t=r.body;if(e instanceof p){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,r.headers||(this.headers=new o(e.headers)),this.method=e.method,this.mode=e.mode,t||null==e._bodyInit||(t=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=r.credentials||this.credentials||"omit",!r.headers&&this.headers||(this.headers=new o(r.headers)),this.method=d(r.method||this.method||"GET"),this.mode=r.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&t)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(t)}function h(e){var r=new FormData;return e.trim().split("&").forEach(function(e){if(e){var t=e.split("="),n=t.shift().replace(/\+/g," "),o=t.join("=").replace(/\+/g," ");r.append(decodeURIComponent(n),decodeURIComponent(o))}}),r}function E(e){var r=new o;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(e){var t=e.split(":"),n=t.shift().trim();if(n){var o=t.join(":").trim();r.append(n,o)}}),r}function y(e,r){r||(r={}),this.type="default",this.status=void 0===r.status?200:r.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in r?r.statusText:"OK",this.headers=new o(r.headers),this.url=r.url||"",this._initBody(e)}if(!e.fetch){var m={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(m.arrayBuffer)var _=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],v=function(e){return e&&DataView.prototype.isPrototypeOf(e)},S=ArrayBuffer.isView||function(e){return e&&_.indexOf(Object.prototype.toString.call(e))>-1};o.prototype.append=function(e,n){e=r(e),n=t(n);var o=this.map[e];this.map[e]=o?o+","+n:n},o.prototype.delete=function(e){delete this.map[r(e)]},o.prototype.get=function(e){return e=r(e),this.has(e)?this.map[e]:null},o.prototype.has=function(e){return this.map.hasOwnProperty(r(e))},o.prototype.set=function(e,n){this.map[r(e)]=t(n)},o.prototype.forEach=function(e,r){for(var t in this.map)this.map.hasOwnProperty(t)&&e.call(r,this.map[t],t,this)},o.prototype.keys=function(){var e=[];return this.forEach(function(r,t){e.push(t)}),n(e)},o.prototype.values=function(){var e=[];return this.forEach(function(r){e.push(r)}),n(e)},o.prototype.entries=function(){var e=[];return this.forEach(function(r,t){e.push([t,r])}),n(e)},m.iterable&&(o.prototype[Symbol.iterator]=o.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},f.call(p.prototype),f.call(y.prototype),y.prototype.clone=function(){return new y(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new o(this.headers),url:this.url})},y.error=function(){var e=new y(null,{status:0,statusText:""});return e.type="error",e};var O=[301,302,303,307,308];y.redirect=function(e,r){if(-1===O.indexOf(r))throw new RangeError("Invalid status code");return new y(null,{status:r,headers:{location:e}})},e.Headers=o,e.Request=p,e.Response=y,e.fetch=function(e,r){return new Promise(function(t,n){var o=new p(e,r),i=new XMLHttpRequest;i.onload=function(){var e={status:i.status,statusText:i.statusText,headers:E(i.getAllResponseHeaders()||"")};e.url="responseURL"in i?i.responseURL:e.headers.get("X-Request-URL");var r="response"in i?i.response:i.responseText;t(new y(r,e))},i.onerror=function(){n(new TypeError("Network request failed"))},i.ontimeout=function(){n(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials?i.withCredentials=!0:"omit"===o.credentials&&(i.withCredentials=!1),"responseType"in i&&m.blob&&(i.responseType="blob"),o.headers.forEach(function(e,r){i.setRequestHeader(r,e)}),i.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function i(e){return e.style.background="none",e.style.border="none",e.style.width="100%",e.style.height="100%",e}Object.defineProperty(r,"__esModule",{value:!0});var a=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),s=t(0),u=t(1),c=t(5),l=n(c),f=t(7),d=n(f),p=t(8),h=n(p),E=t(3),y=n(E),m=t(9),_=n(m),v=function(e,r,t){var n=document.createElement("iframe");return n.setAttribute("id",r),i(n),e.appendChild(n),{getIframe:function(){return n},load:function(){n.src=t},getContentWindow:function(){return n.contentWindow}}},S=function(e){for(;e&&e.firstChild;)e.removeChild(e.firstChild)},b=function(e){return(0,u.post)({targetResource:s.CHILD_RESOURCE,fnName:s.INIT_CHILD,payload:{childId:e}})},O=function(e){return(0,u.post)({targetResource:s.CHILD_RESOURCE,fnName:s.REMOVE_CHILD,payload:{childId:e}})},g=function(e){return(0,u.post)({targetResource:s.CHILD_RESOURCE,fnName:s.CREATE_CHILD,payload:{createOptions:e}})},w=function(e){return(0,u.post)({targetResource:s.CHILD_RESOURCE,fnName:s.DELETE_CHILD,payload:{childId:e}})},T=function(e,r){(0,u.listenOnce)({fnName:s.GET_NONCE,window:e,callback:function(){return{nonce:r}}})},R=function(){function e(r){o(this,e),this.id=r,this.element=void 0}return a(e,[{key:"init",value:function(e){var r=this;return this.element=e,b(this.id).then(function(t){var n=t.data,o=n.nonce,i=n.entryPoint,a=v(e,r.id,i.entryPoint);T(a.getContentWindow(),o),a.load()})}},{key:"remove",value:function(){var e=this;return O(this.id).then(function(){S(e.element)})}},{key:"create",value:function(e){var r=e.name,t=e.plugin;return g({name:r,plugin:t}).then(function(e){if(e.data.success)return e.data.success;throw new Error(e.data.error)})}},{key:"delete",value:function(){var e=this;return w(this.id).then(function(){S(e.element)})}},{key:"state",value:function(){return(0,y.default)(this.id,!0).apply(void 0,arguments)}},{key:"access",value:function(){return l.default.apply(void 0,arguments)}},{key:"progress",value:function(){return(0,d.default)(this.id).apply(void 0,arguments)}},{key:"competency",value:function(){return(0,h.default)(this.id).apply(void 0,arguments)}},{key:"learner",value:function(){return(0,_.default)(this.id).apply(void 0,arguments)}}]),e}();r.default=R,e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(1),o=t(0),i=t(2),a=function(e){return e&&e.__esModule?e:{default:e}}(i),s=function(e,r){return new a.default(function(r){(0,n.createListener)({resource:o.SUBSCRIPTION,fnName:e,callback:function(e){r.next(e.data)}})},r)},u=function(){return{select:function(e){return(0,n.post)({targetResource:o.EDITOR_RESOURCE,fnName:o.SELECT,payload:{selection:e}})},selection:function(e){return{subscribe:function(r){return(0,n.post)({targetResource:o.EDITOR_RESOURCE,fnName:o.SUBSCRIBE_TO_SELECTION,payload:{selection:e,optionalCallbackFn:r}}).then(function(e){var t=e.data,n=t.subscriptionId,o=t.unsubscribeFn,i=t.initialNotifyAfterReturn;return r?{subscriptionId:n,unsubscribe:o}:(i&&setTimeout(function(){i()}),s(n,o))})}}},open:function(e){return(0,n.post)({targetResource:o.EDITOR_RESOURCE,fnName:o.OPEN,payload:{activityId:e}})}}};r.default=u,e.exports=r.default},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(){return w++,w.toString()}function i(e,r){var t=r.dragType,n=r.dragData;g[e]={domainName:e,dragType:t,dragData:n}}function a(e){g[e]=null}function s(e){for(var r=[],t=Object.keys(O[e]),n=0;n<t.length;n++){var o=t[n],i=O[e][o].el.getBoundingClientRect(),a={droppableId:o,rect:{x:i.left,y:i.top,w:i.width,h:i.height}};r.push(a)}return r}function u(e,r,t){for(var n=0;n<t.length;n++){var o=t[n],i=O[e][o].el,a=new v.default(r,{detail:g[e]});i.dispatchEvent(a)}}function c(e,r){return i(e,r),{hitAreas:s(e),triggerEventOnDroppables:u.bind(null,e)}}function l(e){a(e)}function f(e){return(0,y.post)({targetResource:m.DRAG_STATE_RESOURCE,fnName:m.SUBSCRIBE_TO_DRAGGABLES,payload:{domainName:e,callbackDragStarted:c.bind(null,e),callbackDragStopped:l.bind(null,e)}})}function d(e){return(0,y.post)({targetResource:m.DRAG_STATE_RESOURCE,fnName:m.UNSUBSCRIBE_FROM_DRAGGABLES,payload:{domainName:e}})}function p(e,r){for(var t=Object.keys(O[r]),n=0;n<t.length;n++){var o=t[n];if(O[r][o].el===e)return o}return null}Object.defineProperty(r,"__esModule",{value:!0});var h=t(19),E=n(h),y=t(1),m=t(0),_=t(20),v=n(_),S=t(21),b=function(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}(S),O={},g={},w=0,T=function(e){return{addDroppable:function(r){if(O[e]&&0!==Object.keys(O[e]).length||(O[e]={},f(e)),null===p(r,e)){var t=o();O[e][t]={droppableId:t,el:r}}},removeDroppable:function(r){if(O[e]){var t=p(r,e);null!==t&&(delete O[e][t],0===Object.keys(O[e]).length&&d(e))}}}};(0,E.default)(T,b),r.default=T,e.exports=r.default},function(e,r,t){"use strict";function n(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
var o=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var r={},t=0;t<10;t++)r["_"+String.fromCharCode(t)]=t;if("0123456789"!==Object.getOwnPropertyNames(r).map(function(e){return r[e]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(e){return!1}}()?Object.assign:function(e,r){for(var t,s,u=n(e),c=1;c<arguments.length;c++){t=Object(arguments[c]);for(var l in t)i.call(t,l)&&(u[l]=t[l]);if(o){s=o(t);for(var f=0;f<s.length;f++)a.call(t,s[f])&&(u[s[f]]=t[s[f]])}}return u}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){function e(e,r){var t=r||{bubbles:!1,cancelable:!1,detail:void 0},n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}return"function"==typeof window.CustomEvent?window.CustomEvent:(e.prototype=window.Event.prototype,e)}();r.default=n,e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});r.domains={PATHWAY_BUILDER_TOOLS_LIST:"DOMAIN_PATHWAY_BUILDER_TOOLS_LIST"},r.dragTypes={TOOL_NEW:"DRAG_TYPE_TOOL_NEW"},r.toolTypes={TEXT:"TOOL_TYPE_TEXT",IMAGE:"TOOL_TYPE_IMAGE",TABLE:"TOOL_TYPE_TABLE",COMPONENT:"TOOL_TYPE_COMPONENT"},r.events={DRAGENTER:"CDPDragStateDragEnter",DRAGLEAVE:"CDPDragStateDragLeave",DROP:"CDPDragStateDrop"}},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(1),o=t(2),i=function(e){return e&&e.__esModule?e:{default:e}}(o),a=t(0),s=function(e){return new i.default(function(r){(0,n.createListener)({resource:a.SUBSCRIPTION,fnName:e,callback:function(e){r.next(e.data)}})})};r.default=function(e){return{get:function(){return(0,n.post)({targetResource:a.THEME_RESOURCE,fnName:a.GET,payload:{path:e}}).then(function(e){return e.data})},subscribe:function(r){return(0,n.post)({targetResource:a.THEME_RESOURCE,fnName:a.SUBSCRIBE,payload:{path:e,optionalCallbackFn:r}}).then(function(e){var t=e.data;return r?t:s(t)})},subscribeToCSS:function(e){return(0,n.post)({targetResource:a.THEME_RESOURCE,fnName:a.SUBSCRIBE_TO_THEME_CSS,payload:{optionalCallbackFn:e}}).then(function(r){var t=r.data;return e?t:s(t)})}}},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(1),i=function(e){return{get:function(){return(0,o.post)({targetResource:n.USER_RESOURCE,fnName:n.GET,payload:{accountId:e}}).then(function(e){return e.data})}}};r.default=i,e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(6),i=function(e){return e&&e.__esModule?e:{default:e}}(o);r.default=(0,i.default)(n.CLASS_RESOURCE),e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(1);r.default=function(){return{get:function(){return(0,o.post)({targetResource:n.CONTEXT_RESOURCE,fnName:n.GET,payload:{}}).then(function(e){return e.data})}}},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(1);r.default=function(e){var r=function(e){return(0,o.post)({targetResource:n.FEATURE_TOGGLE_RESOURCE,fnName:n.IS,payload:e}).then(function(e){return e.data})},t=function(){return(0,o.post)({targetResource:n.FEATURE_TOGGLE_RESOURCE,fnName:n.GET,payload:{}}).then(function(e){return e.data})},i=function(e){return r(e).then(function(e){return e.enabled})},a=function(e){return r(e).then(function(e){return e.disabled})},s=function(e){return r(e).then(function(e){return e.unknown})};return e?{isEnabled:function(){return i(e)},isDisabled:function(){return a(e)},isUnknown:function(){return s(e)}}:{is:r,get:t}},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(1),o=t(0);r.default=function(e){return(0,n.post)({targetResource:o.QUERY_RESOURCE,fnName:o.EXECUTE_QUERY,payload:{query:e}})},e.exports=r.default},function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=t(0),o=t(1);r.default=function(){return{moveOn:function(){return(0,o.post)({targetResource:n.DEPRECATED_RESOURCE,fnName:n.DEPRECATED_CONTINUE,payload:{}}).then(function(e){return e.data})}}},e.exports=r.default}])});